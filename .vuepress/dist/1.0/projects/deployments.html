<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Deployments | Laravel Vapor</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,800,800i,900,900i" rel="stylesheet" type="text/css">
    <meta name="description" content="Laravel at Infinite Scale">
    
    <link rel="preload" href="/assets/css/0.styles.c1eb0935.css" as="style"><link rel="preload" href="/assets/js/app.ab223af1.js" as="script"><link rel="preload" href="/assets/js/2.792bbc0a.js" as="script"><link rel="preload" href="/assets/js/12.300d067b.js" as="script"><link rel="prefetch" href="/assets/js/10.610ab63b.js"><link rel="prefetch" href="/assets/js/11.0d45e37d.js"><link rel="prefetch" href="/assets/js/13.4e9a9d90.js"><link rel="prefetch" href="/assets/js/14.756798a6.js"><link rel="prefetch" href="/assets/js/15.c0ce5052.js"><link rel="prefetch" href="/assets/js/16.6a0b5690.js"><link rel="prefetch" href="/assets/js/17.d335dd05.js"><link rel="prefetch" href="/assets/js/18.4e60f126.js"><link rel="prefetch" href="/assets/js/19.503256ac.js"><link rel="prefetch" href="/assets/js/20.2c0a75c3.js"><link rel="prefetch" href="/assets/js/21.72d055f1.js"><link rel="prefetch" href="/assets/js/22.bfb947e7.js"><link rel="prefetch" href="/assets/js/3.2a93f1b4.js"><link rel="prefetch" href="/assets/js/4.0efab4ce.js"><link rel="prefetch" href="/assets/js/5.6d32f951.js"><link rel="prefetch" href="/assets/js/6.88f97fe0.js"><link rel="prefetch" href="/assets/js/7.a8797844.js"><link rel="prefetch" href="/assets/js/8.381e667c.js"><link rel="prefetch" href="/assets/js/9.2ca5bd96.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c1eb0935.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Laravel Vapor</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://vapor.laravel.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://vapor.laravel.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Getting Started</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/1.0/introduction.html" class="sidebar-link">Introduction</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/introduction.html#what-is-vapor" class="sidebar-link">What Is Vapor?</a></li><li class="sidebar-sub-header"><a href="/1.0/introduction.html#requirements" class="sidebar-link">Requirements</a></li><li class="sidebar-sub-header"><a href="/1.0/introduction.html#account-creation" class="sidebar-link">Account Creation</a></li><li class="sidebar-sub-header"><a href="/1.0/introduction.html#installing-the-vapor-cli" class="sidebar-link">Installing The Vapor CLI</a></li><li class="sidebar-sub-header"><a href="/1.0/introduction.html#installing-the-vapor-core" class="sidebar-link">Installing The Vapor Core</a></li><li class="sidebar-sub-header"><a href="/1.0/introduction.html#installing-the-vapor-ui-dashboard" class="sidebar-link">Installing The Vapor UI Dashboard</a></li><li class="sidebar-sub-header"><a href="/1.0/introduction.html#teams" class="sidebar-link">Teams</a></li><li class="sidebar-sub-header"><a href="/1.0/introduction.html#linking-with-aws" class="sidebar-link">Linking With AWS</a></li><li class="sidebar-sub-header"><a href="/1.0/introduction.html#notification-methods" class="sidebar-link">Notification Methods</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Projects</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/1.0/projects/the-basics.html" class="sidebar-link">The Basics</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/projects/the-basics.html#creating-projects" class="sidebar-link">Creating Projects</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/the-basics.html#project-settings" class="sidebar-link">Project Settings</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/the-basics.html#deleting-projects" class="sidebar-link">Deleting Projects</a></li></ul></li><li><a href="/1.0/projects/environments.html" class="sidebar-link">Environments</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#creating-environments" class="sidebar-link">Creating Environments</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#opening-environments" class="sidebar-link">Opening Environments</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#environment-variables" class="sidebar-link">Environment Variables</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#secrets" class="sidebar-link">Secrets</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#vanity-urls" class="sidebar-link">Vanity URLs</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#custom-domains" class="sidebar-link">Custom Domains</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#maintenance-mode" class="sidebar-link">Maintenance Mode</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#commands" class="sidebar-link">Commands</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#memory" class="sidebar-link">Memory</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#concurrency" class="sidebar-link">Concurrency</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#provisioned-concurrency" class="sidebar-link">Provisioned Concurrency</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#prewarming" class="sidebar-link">Prewarming</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#firewall" class="sidebar-link">Firewall</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#timeout" class="sidebar-link">Timeout</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#scheduler" class="sidebar-link">Scheduler</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#mail" class="sidebar-link">Mail</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#metrics" class="sidebar-link">Metrics</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#runtime" class="sidebar-link">Runtime</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#octane" class="sidebar-link">Octane</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#gateway-versions" class="sidebar-link">Gateway Versions</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#custom-vpcs" class="sidebar-link">Custom VPCs</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#deleting-environments" class="sidebar-link">Deleting Environments</a></li></ul></li><li><a href="/1.0/projects/deployments.html" aria-current="page" class="active sidebar-link">Deployments</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/projects/deployments.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/deployments.html#initiating-deployments" class="sidebar-link">Initiating Deployments</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/deployments.html#build-hooks" class="sidebar-link">Build Hooks</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/deployments.html#deploy-hooks" class="sidebar-link">Deploy Hooks</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/deployments.html#assets" class="sidebar-link">Assets</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/deployments.html#redeploying" class="sidebar-link">Redeploying</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/deployments.html#rollbacks" class="sidebar-link">Rollbacks</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/deployments.html#deploying-from-ci" class="sidebar-link">Deploying From CI</a></li></ul></li><li><a href="/1.0/projects/development.html" class="sidebar-link">Development</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/projects/development.html#binary-responses" class="sidebar-link">Binary Responses</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/development.html#configuring-openssl" class="sidebar-link">Configuring OpenSSL</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/development.html#after-response-jobs" class="sidebar-link">&quot;After Response&quot; Jobs</a></li></ul></li><li><a href="/1.0/projects/troubleshooting.html" class="sidebar-link">Troubleshooting</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/projects/troubleshooting.html#performance-issues" class="sidebar-link">Performance Issues</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/troubleshooting.html#_502-bad-gateway-or-internal-server-error" class="sidebar-link">502 Bad Gateway Or &quot;Internal Server Error&quot;</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Resources</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/1.0/resources/queues.html" class="sidebar-link">Queues</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/resources/queues.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/queues.html#custom-queue-names" class="sidebar-link">Custom Queue Names</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/queues.html#queue-concurrency" class="sidebar-link">Queue Concurrency</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/queues.html#queue-visibility-timeout" class="sidebar-link">Queue Visibility Timeout</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/queues.html#queue-memory" class="sidebar-link">Queue Memory</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/queues.html#queue-database-connections" class="sidebar-link">Queue Database Connections</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/queues.html#monitoring-jobs" class="sidebar-link">Monitoring Jobs</a></li></ul></li><li><a href="/1.0/resources/storage.html" class="sidebar-link">Storage</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/resources/storage.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/storage.html#attaching-storage" class="sidebar-link">Attaching Storage</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/storage.html#mounting-a-persistent-file-system" class="sidebar-link">Mounting A Persistent File System</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/storage.html#file-uploads" class="sidebar-link">File Uploads</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/storage.html#temporary-storage" class="sidebar-link">Temporary Storage</a></li></ul></li><li><a href="/1.0/resources/networks.html" class="sidebar-link">Networks</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/resources/networks.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/networks.html#jumpboxes" class="sidebar-link">Jumpboxes</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/networks.html#nat-gateways" class="sidebar-link">NAT Gateways</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/networks.html#load-balancers" class="sidebar-link">Load Balancers</a></li></ul></li><li><a href="/1.0/resources/databases.html" class="sidebar-link">Databases</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/resources/databases.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/databases.html#creating-databases" class="sidebar-link">Creating Databases</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/databases.html#using-databases" class="sidebar-link">Using Databases</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/databases.html#database-proxies" class="sidebar-link">Database Proxies</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/databases.html#database-users" class="sidebar-link">Database Users</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/databases.html#scaling-databases" class="sidebar-link">Scaling Databases</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/databases.html#restoring-databases" class="sidebar-link">Restoring Databases</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/databases.html#upgrading-databases" class="sidebar-link">Upgrading Databases</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/databases.html#metrics" class="sidebar-link">Metrics</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/databases.html#deleting-databases" class="sidebar-link">Deleting Databases</a></li></ul></li><li><a href="/1.0/resources/caches.html" class="sidebar-link">Caches</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/resources/caches.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/caches.html#creating-caches" class="sidebar-link">Creating Caches</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/caches.html#using-caches" class="sidebar-link">Using Caches</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/caches.html#scaling-caches" class="sidebar-link">Scaling Caches</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/caches.html#metrics" class="sidebar-link">Metrics</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/caches.html#dynamodb-caches" class="sidebar-link">DynamoDB Caches</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/caches.html#deleting-caches" class="sidebar-link">Deleting Caches</a></li></ul></li><li><a href="/1.0/resources/logs.html" class="sidebar-link">Logs</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/resources/logs.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/logs.html#viewing-logs" class="sidebar-link">Viewing Logs</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Domains</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/1.0/domains/dns.html" class="sidebar-link">DNS</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/domains/dns.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/1.0/domains/dns.html#creating-dns-zones" class="sidebar-link">Creating DNS Zones</a></li><li class="sidebar-sub-header"><a href="/1.0/domains/dns.html#nameservers" class="sidebar-link">Nameservers</a></li><li class="sidebar-sub-header"><a href="/1.0/domains/dns.html#managing-dns-records" class="sidebar-link">Managing DNS Records</a></li><li class="sidebar-sub-header"><a href="/1.0/domains/dns.html#deleting-zones" class="sidebar-link">Deleting Zones</a></li></ul></li><li><a href="/1.0/domains/certificates.html" class="sidebar-link">Certificates</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/domains/certificates.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/1.0/domains/certificates.html#creating-certificates" class="sidebar-link">Creating Certificates</a></li><li class="sidebar-sub-header"><a href="/1.0/domains/certificates.html#deleting-certificates" class="sidebar-link">Deleting Certificates</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="deployments"><a href="#deployments" class="header-anchor">#</a> Deployments</h1> <p></p><div class="table-of-contents"><ul><li><a href="#introduction">Introduction</a></li><li><a href="#initiating-deployments">Initiating Deployments</a></li><li><a href="#build-hooks">Build Hooks</a></li><li><a href="#deploy-hooks">Deploy Hooks</a><ul><li><a href="#reviewing-output-logs">Reviewing Output / Logs</a></li></ul></li><li><a href="#assets">Assets</a><ul><li><a href="#referencing-assets-from-javascript">Referencing Assets From JavaScript</a></li><li><a href="#code-splitting-dynamic-imports">Code Splitting / Dynamic Imports</a></li><li><a href="#hot-module-replacement">Hot Module Replacement</a></li><li><a href="#urls-within-css">URLs Within CSS</a></li><li><a href="#root-domain-assets">Root Domain Assets</a></li><li><a href="#dot-files-as-assets">Dot Files As Assets</a></li></ul></li><li><a href="#redeploying">Redeploying</a></li><li><a href="#rollbacks">Rollbacks</a></li><li><a href="#deploying-from-ci">Deploying From CI</a><ul><li><a href="#git-commit-information">Git Commit Information</a></li><li><a href="#example-with-github-actions">Example With GitHub Actions</a></li><li><a href="#example-with-chipper-ci">Example With Chipper CI</a></li></ul></li></ul></div><p></p> <h2 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h2> <p>Of course, one of the primary features of Laravel Vapor is atomic, zero-downtime deployments. Unlike many other features of Vapor, deployments are <strong>only initiated via the Vapor CLI</strong>. During deployment, Vapor will run the <code>build</code> steps of your <code>vapor.yml</code> file on the local machine that the deployment is running on. This might be your personal machine or a continuous integration platform.</p> <h2 id="initiating-deployments"><a href="#initiating-deployments" class="header-anchor">#</a> Initiating Deployments</h2> <p>To initiate a deployment, execute the <code>deploy</code> CLI command from the root of your application:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>vapor deploy production
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">Application Size</p> <p>AWS Lambda has strict limitations on the size of applications running within the environment. If your application exceeds this limit, you may take advantage of Vapor's <a href="https://docs.vapor.build/1.0/projects/environments.html#building-custom-docker-images" target="_blank" rel="noopener noreferrer">Docker based deployments<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. Docker based deployments allow you to package and deploy applications up to 10GB in size.</p></div> <h2 id="build-hooks"><a href="#build-hooks" class="header-anchor">#</a> Build Hooks</h2> <p>You may define build hooks for an environment using the <code>build</code> key within your <code>vapor.yml</code> file. These commands are executed on the local machine that the deployment is running on and may be used to prepare your application for deployment. During deployment, your application is built within a temporary <code>.vapor</code> directory that is created by the CLI and all of your <code>build</code> commands will run within that temporary directory:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">id</span><span class="token punctuation">:</span> <span class="token number">3</span>
<span class="token key atrule">name</span><span class="token punctuation">:</span> vapor<span class="token punctuation">-</span>app
<span class="token key atrule">environments</span><span class="token punctuation">:</span>
    <span class="token key atrule">production</span><span class="token punctuation">:</span>
        <span class="token key atrule">memory</span><span class="token punctuation">:</span> <span class="token number">1024</span>
        <span class="token key atrule">database</span><span class="token punctuation">:</span> vapor<span class="token punctuation">-</span>app
        <span class="token key atrule">cache</span><span class="token punctuation">:</span> vapor<span class="token punctuation">-</span>cache
        <span class="token key atrule">build</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token string">'composer install --no-dev'</span>
            <span class="token punctuation">-</span> <span class="token string">'php artisan event:cache'</span>
        <span class="token key atrule">deploy</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token string">'php artisan migrate --force'</span>
</code></pre></div><h2 id="deploy-hooks"><a href="#deploy-hooks" class="header-anchor">#</a> Deploy Hooks</h2> <p>You may define deployment hooks for an environment using the <code>deploy</code> key within your <code>vapor.yml</code> file. These commands are executed against the deployed environment <strong>before it is activated for general availability</strong>. If any of these commands fail, the deployment will not be activated.</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">id</span><span class="token punctuation">:</span> <span class="token number">3</span>
<span class="token key atrule">name</span><span class="token punctuation">:</span> vapor<span class="token punctuation">-</span>app
<span class="token key atrule">environments</span><span class="token punctuation">:</span>
    <span class="token key atrule">production</span><span class="token punctuation">:</span>
        <span class="token key atrule">memory</span><span class="token punctuation">:</span> <span class="token number">1024</span>
        <span class="token key atrule">database</span><span class="token punctuation">:</span> vapor<span class="token punctuation">-</span>app
        <span class="token key atrule">cache</span><span class="token punctuation">:</span> vapor<span class="token punctuation">-</span>cache
        <span class="token key atrule">build</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token string">'composer install --no-dev'</span>
            <span class="token punctuation">-</span> <span class="token string">'php artisan event:cache'</span>
        <span class="token key atrule">deploy</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token string">'php artisan migrate --force'</span>
</code></pre></div><h3 id="reviewing-output-logs"><a href="#reviewing-output-logs" class="header-anchor">#</a> Reviewing Output / Logs</h3> <p>When a deployment hook fails, you may review the output / logs via the Vapor UI's deployment detail screen.</p> <p>Also, if you are deploying your application using the <code>vapor deploy</code> command, the CLI output will contain the failing hook output. Of course, you may review the output at any time using the <code>hook:output</code> command:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>vapor hook:output <span class="token punctuation">{</span>DEPLOYMENT_HOOK_ID<span class="token punctuation">}</span>
</code></pre></div><p>You can review the logs associated with the failing hook using the <code>hook:log</code> command:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>vapor hook:log <span class="token punctuation">{</span>DEPLOYMENT_HOOK_ID<span class="token punctuation">}</span>
</code></pre></div><h2 id="assets"><a href="#assets" class="header-anchor">#</a> Assets</h2> <p>During deployment, Vapor will automatically extract all of the assets in your Laravel project's <code>public</code> directory and upload them to S3. In addition, Vapor will create a AWS CloudFront (CDN) distribution to distribute these assets efficiently around the world.</p> <p>Because all of your assets will be served via S3 / CloudFront, you should always generate URLs to these assets using Laravel's <code>asset</code> helper. Vapor injects an <code>ASSET_URL</code> environment variable which Laravel's <code>asset</code> helper will use when constructing your URLs:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string double-quoted-string">&quot;{{ asset('img.jpg') }}&quot;</span><span class="token operator">&gt;</span>
</code></pre></div><p>On subsequent deployments, only the assets that have changed will be uploaded to S3, while unchanged assets will be copied over from the previous deployment.</p> <h3 id="referencing-assets-from-javascript"><a href="#referencing-assets-from-javascript" class="header-anchor">#</a> Referencing Assets From JavaScript</h3> <p>If you are referencing your project's public assets in your JavaScript code, you may generate URLs to these assets using Vapor's NPM package. This package includes a <code>Vapor.asset</code> helper that will behave like Laravel's <code>asset</code> helper but on the client. To get started, install the <code>laravel-vapor</code> NPM package:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> --save-dev laravel-vapor
</code></pre></div><p>Next, within your application's <code>app.js</code> file, initialize the global Vapor JavaScript object:</p> <div class="language-js extra-class"><pre class="language-js"><code>window<span class="token punctuation">.</span>Vapor <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'laravel-vapor'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Finally, you may call the <code>Vapor.asset</code> helper in your JavaScript code:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#container'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">prepend</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'&lt;img&gt;'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">src</span><span class="token operator">:</span> Vapor<span class="token punctuation">.</span><span class="token function">asset</span><span class="token punctuation">(</span><span class="token string">'avatar.png'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>Or, if you are using Vue, you may find it convenient to add the following mixin to your Vue application:</p> <div class="language- extra-class"><pre class="language-text"><code>Vue.mixin({
    methods: {
        asset: window.Vapor.asset
    },
});

// Within your Vue components...
&lt;img :src=&quot;asset('img/global/logo.svg')&quot;/&gt;
</code></pre></div><h3 id="code-splitting-dynamic-imports"><a href="#code-splitting-dynamic-imports" class="header-anchor">#</a> Code Splitting / Dynamic Imports</h3> <p>If you are taking advantage of JavaScript dynamic imports and code splitting in your project, you will need to let Webpack know where the child chunks will be loaded from for each deployment. To accomplish this, you can take advantage of the <code>ASSET_URL</code> variable that Laravel Vapor injects into your environment during your build step:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> mix <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;laravel-mix&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*
 |--------------------------------------------------------------------------
 | Mix Asset Management
 |--------------------------------------------------------------------------
 |
 | Mix provides a clean, fluent API for defining some Webpack build steps
 | for your Laravel application. By default, we are compiling the Sass
 | file for the application as well as bundling up all the JS files.
 |
 */</span>

mix
  <span class="token punctuation">.</span><span class="token function">js</span><span class="token punctuation">(</span><span class="token string">&quot;resources/js/app.js&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;public/js&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">sass</span><span class="token punctuation">(</span><span class="token string">&quot;resources/sass/app.scss&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;public/css&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>mix<span class="token punctuation">.</span><span class="token function">inProduction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token constant">ASSET_URL</span> <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">ASSET_URL</span> <span class="token operator">+</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">;</span>

    mix<span class="token punctuation">.</span><span class="token function">webpackConfig</span><span class="token punctuation">(</span><span class="token parameter">webpack</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                    <span class="token string-property property">&quot;process.env.ASSET_PATH&quot;</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token constant">ASSET_URL</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">publicPath</span><span class="token operator">:</span> <span class="token constant">ASSET_URL</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="hot-module-replacement"><a href="#hot-module-replacement" class="header-anchor">#</a> Hot Module Replacement</h3> <p>If you are using code splitting and &quot;hot module replacement&quot; during local development, you will need to use the <code>mix</code> helper locally and the <code>asset</code> helper when deploying to Vapor:</p> <div class="language-php extra-class"><pre class="language-php"><code>@<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">environment</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'local'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token operator">&lt;</span>link href<span class="token operator">=</span><span class="token string double-quoted-string">&quot;{{ mix('css/admin/app.css') }}&quot;</span> rel<span class="token operator">=</span><span class="token string double-quoted-string">&quot;stylesheet&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string double-quoted-string">&quot;{{ mix('js/admin/app.js') }}&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
@<span class="token keyword">else</span>
    <span class="token operator">&lt;</span>link href<span class="token operator">=</span><span class="token string double-quoted-string">&quot;{{ asset('css/admin/app.css') }}&quot;</span> rel<span class="token operator">=</span><span class="token string double-quoted-string">&quot;stylesheet&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string double-quoted-string">&quot;{{ asset('js/admin/app.js') }}&quot;</span> defer<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
@<span class="token keyword">endif</span>
</code></pre></div><h3 id="urls-within-css"><a href="#urls-within-css" class="header-anchor">#</a> URLs Within CSS</h3> <p>Sometimes, your CSS may need to reference asset URLs, such as a <code>background-image</code> property that references an image via URL. Obviously, you are not able to use the PHP <code>asset</code> helper within your CSS. For this reason, Vapor will automatically prepend the correct asset base URL to all relative URLs in your CSS during the build process. After your build steps have executed, Vapor performs this action against any CSS files in your application's <code>public</code> directory (including directories nested under <code>public</code>).</p> <h3 id="root-domain-assets"><a href="#root-domain-assets" class="header-anchor">#</a> Root Domain Assets</h3> <p>Some applications, such as PWAs, may need to serve certain assets from the root domain. If your application has this need, you can define an array of assets that should be served from your application's root domain via the <code>serve_assets</code> configuration option within your <code>vapor</code> configuration file:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/*
|--------------------------------------------------------------------------
| Servable Assets
|--------------------------------------------------------------------------
|
| Here you can configure list of public assets that should be servable
| from your application's domain instead of only being servable via
| the public S3 &quot;asset&quot; bucket or the AWS CloudFront CDN network.
|
*/</span>

<span class="token string single-quoted-string">'serve_assets'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
    <span class="token string single-quoted-string">'serviceWorker.js'</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div><p>If your application doesn't contain a <code>vapor</code> configuration file, you can publish it using the <code>vendor:publish</code> Artisan command:</p> <div class="language- extra-class"><pre class="language-text"><code>php artisan vendor:publish --tag=vapor-config
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">Performance Penalty</p> <p>Due to the serverless nature of applications powered by Vapor, assets served from the root domain are not cacheable at the client-side and they are served using Laravel routes. Therefore, you should only serve assets that absolutely must be served from the root domain as there is a slight performance penalty for doing so.</p></div> <h3 id="dot-files-as-assets"><a href="#dot-files-as-assets" class="header-anchor">#</a> Dot Files As Assets</h3> <p>Typically, &quot;dot&quot; files are not uploaded to the AWS CloudFront CDN by Vapor. However, if you need the public directory's dot files to be uploaded as assets, you should set the <code>dot-files-as-assets</code> key to <code>true</code> in your <code>vapor.yml</code> file:</p> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">id</span><span class="token punctuation">:</span> <span class="token number">1</span>
<span class="token key atrule">name</span><span class="token punctuation">:</span> app<span class="token punctuation">-</span>test
<span class="token key atrule">dot-files-as-assets</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre></div><p>You may also choose to serve asset dot files from the application's root domain:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token string single-quoted-string">'serve_assets'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
    <span class="token string single-quoted-string">'serviceWorker.js'</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">'.well-known/assetlinks.json'</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="redeploying"><a href="#redeploying" class="header-anchor">#</a> Redeploying</h2> <p>Sometimes you may need to simply redeploy a given environment without rebuilding it. For example, you may wish to do this after updating an environment variable. To accomplish this, you may use the Vapor UI or the <code>redeploy</code> CLI command:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>vapor redeploy production
</code></pre></div><h2 id="rollbacks"><a href="#rollbacks" class="header-anchor">#</a> Rollbacks</h2> <p>To rollback to a previous deployment, you may select the deployment in the Vapor UI and click the &quot;Rollback To&quot; button, or you may use the <code>rollback</code> CLI command. The <code>rollback</code> command's &quot;--select&quot; option will allow you to select which deployment to rollback to from a list of recent deployments. If the <code>rollback</code> command is executed without this option, it will simply rollback to the most previous successful deployment:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>vapor rollback production

vapor rollback production --select
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">Variables, Secrets, &amp; Rollbacks</p> <p>When rolling back to a previous deployment, Vapor will use the environment's variables and secrets as they existed at the time the deployment you're rolling back to was originally deployed.</p></div> <h2 id="deploying-from-ci"><a href="#deploying-from-ci" class="header-anchor">#</a> Deploying From CI</h2> <p>So far, we have discussed deploying Vapor projects from your local command line. However, you may also deploy them from a CI platform of your choice. Since the Vapor CLI client is part of your Composer dependencies, you may simply execute the <code>vapor deploy</code> command in your CI platform's deployment pipeline.</p> <p>In order to authenticate with Vapor from your CI platform, you will need to add a <code>VAPOR_API_TOKEN</code> environment variable to your CI build environment. You may generate an API token in your <a href="https://vapor.laravel.com/app/account/api-tokens" target="_blank" rel="noopener noreferrer">Vapor API settings dashboard<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h3 id="git-commit-information"><a href="#git-commit-information" class="header-anchor">#</a> Git Commit Information</h3> <p>Some CI platforms expose the Git commit information as environment variables during your build. You may pass this information to the <code>vapor deploy</code> command. For example, if using CodeShip:</p> <div class="language-sh extra-class"><pre class="language-sh"><code>vapor deploy production --commit<span class="token operator">=</span><span class="token string">&quot;<span class="token variable">${CI_COMMIT_ID}</span>&quot;</span> --message<span class="token operator">=</span><span class="token string">&quot;<span class="token variable">${CI_MESSAGE}</span>&quot;</span>
</code></pre></div><h3 id="example-with-github-actions"><a href="#example-with-github-actions" class="header-anchor">#</a> Example With GitHub Actions</h3> <p>If your application uses <a href="https://github.com/features/actions" target="_blank" rel="noopener noreferrer">GitHub Actions<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> as its CI platform, the following guidelines will assist you in configuring Vapor deployments so that your application is automatically deployed when someone pushes a commit to the <code>master</code> branch:</p> <ol><li><p>First, add the <code>VAPOR_API_TOKEN</code> environment variable to your &quot;GitHub &gt; Project Settings &gt; Secrets&quot; settings so that GitHub can authenticate with Vapor while running actions.</p></li> <li><p>Next, create a <code>deploy.yml</code> file within the <code>your-project/.github/workflows</code> directory. The file should have the following contents:</p></li></ol> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">name</span><span class="token punctuation">:</span> Deploy

<span class="token key atrule">on</span><span class="token punctuation">:</span>
  <span class="token key atrule">push</span><span class="token punctuation">:</span>
    <span class="token key atrule">branches</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> master <span class="token punctuation">]</span>

<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">deploy</span><span class="token punctuation">:</span>
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Checkout code
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v2
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Setup PHP
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> shivammathur/setup<span class="token punctuation">-</span>php@v2
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">php-version</span><span class="token punctuation">:</span> <span class="token number">8.0</span>
          <span class="token key atrule">tools</span><span class="token punctuation">:</span> composer<span class="token punctuation">:</span>v2
          <span class="token key atrule">coverage</span><span class="token punctuation">:</span> none
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Require Vapor CLI
        <span class="token key atrule">run</span><span class="token punctuation">:</span> composer global require laravel/vapor<span class="token punctuation">-</span>cli
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Install Project Dependencies
        <span class="token key atrule">run</span><span class="token punctuation">:</span> composer install <span class="token punctuation">-</span><span class="token punctuation">-</span>no<span class="token punctuation">-</span>interaction <span class="token punctuation">-</span><span class="token punctuation">-</span>prefer<span class="token punctuation">-</span>dist <span class="token punctuation">-</span><span class="token punctuation">-</span>optimize<span class="token punctuation">-</span>autoloader
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Deploy Environment
        <span class="token key atrule">run</span><span class="token punctuation">:</span> vapor deploy
        <span class="token key atrule">env</span><span class="token punctuation">:</span>
          <span class="token key atrule">VAPOR_API_TOKEN</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> secrets.VAPOR_API_TOKEN <span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre></div><ol start="3"><li>Finally, you can edit the <code>deploy.yml</code> file to fit your application's deployment needs, as it may require a different PHP version or a library like <code>npm</code>. Once you are done, commit and push the <code>deploy.yml</code> file to <code>master</code> so GitHub Actions can run the first deployment job.</li></ol> <h3 id="example-with-chipper-ci"><a href="#example-with-chipper-ci" class="header-anchor">#</a> Example With Chipper CI</h3> <p>If your application uses <a href="https://chipperci.com/" target="_blank" rel="noopener noreferrer">Chipper CI<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> as its CI platform, the following guidelines will assist you in configuring Vapor deployments so that your application is automatically deployed when someone pushes a commit to the <code>master</code> branch:</p> <ol><li><p>First, add the <code>VAPOR_API_TOKEN</code> environment variable to your &quot;Chipper CI &gt; Project Settings &gt; Project Environment Variables&quot; settings so that Chipper CI can authenticate with Vapor while running your build pipeline.</p></li> <li><p>Then, on the &quot;Build Pipeline&quot; dashboard, add a step with the name <code>Deploy</code> and the following content:</p></li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$CI_COMMIT_BRANCH</span> <span class="token operator">==</span> <span class="token string">'master'</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token function">composer</span> <span class="token function">install</span> --no-interaction --prefer-dist --optimize-autoloader

    <span class="token function">composer</span> global require laravel/vapor-cli

    vapor deploy
<span class="token keyword">fi</span>
</code></pre></div><ol start="3"><li>Next, commit and push any change to the <code>master</code> branch so that Chipper CI will deploy your application.</li></ol> <div class="custom-block warning"><p class="custom-block-title">Docker Based Runtimes</p> <p>If you plan to use Docker based runtimes to run your Vapor application, you must purchase a Chipper CI paid plan and enable Docker in each project that contains a Docker based Vapor application.</p></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      
      <a href="/1.0/projects/environments.html" class="prev">
        Environments
      </a></span> <span class="next"><a href="/1.0/projects/development.html">
        Development
      </a>
      
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.ab223af1.js" defer></script><script src="/assets/js/2.792bbc0a.js" defer></script><script src="/assets/js/12.300d067b.js" defer></script>
  </body>
</html>
