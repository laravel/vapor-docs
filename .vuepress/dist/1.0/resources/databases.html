<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Databases | Laravel Vapor</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,800,800i,900,900i" rel="stylesheet" type="text/css">
    <meta name="description" content="Laravel at Infinite Scale">
    
    <link rel="preload" href="/assets/css/0.styles.c1eb0935.css" as="style"><link rel="preload" href="/assets/js/app.f51d531d.js" as="script"><link rel="preload" href="/assets/js/2.cb24c26d.js" as="script"><link rel="preload" href="/assets/js/6.2129aa45.js" as="script"><link rel="prefetch" href="/assets/js/10.92914f14.js"><link rel="prefetch" href="/assets/js/11.0d45e37d.js"><link rel="prefetch" href="/assets/js/12.946d8314.js"><link rel="prefetch" href="/assets/js/13.4e9a9d90.js"><link rel="prefetch" href="/assets/js/14.756798a6.js"><link rel="prefetch" href="/assets/js/15.d7a4de81.js"><link rel="prefetch" href="/assets/js/16.6a0b5690.js"><link rel="prefetch" href="/assets/js/17.f989454d.js"><link rel="prefetch" href="/assets/js/18.912e875e.js"><link rel="prefetch" href="/assets/js/19.a1938aa8.js"><link rel="prefetch" href="/assets/js/20.ecea9f8d.js"><link rel="prefetch" href="/assets/js/21.9e7e1f3e.js"><link rel="prefetch" href="/assets/js/22.b0de87ee.js"><link rel="prefetch" href="/assets/js/3.2a93f1b4.js"><link rel="prefetch" href="/assets/js/4.0efab4ce.js"><link rel="prefetch" href="/assets/js/5.6d32f951.js"><link rel="prefetch" href="/assets/js/7.a8797844.js"><link rel="prefetch" href="/assets/js/8.0d7a0cb0.js"><link rel="prefetch" href="/assets/js/9.2ca5bd96.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c1eb0935.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Laravel Vapor</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://vapor.laravel.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://vapor.laravel.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Getting Started</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/1.0/introduction.html" class="sidebar-link">Introduction</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/introduction.html#what-is-vapor" class="sidebar-link">What Is Vapor?</a></li><li class="sidebar-sub-header"><a href="/1.0/introduction.html#requirements" class="sidebar-link">Requirements</a></li><li class="sidebar-sub-header"><a href="/1.0/introduction.html#account-creation" class="sidebar-link">Account Creation</a></li><li class="sidebar-sub-header"><a href="/1.0/introduction.html#installing-the-vapor-cli" class="sidebar-link">Installing The Vapor CLI</a></li><li class="sidebar-sub-header"><a href="/1.0/introduction.html#installing-the-vapor-core" class="sidebar-link">Installing The Vapor Core</a></li><li class="sidebar-sub-header"><a href="/1.0/introduction.html#installing-the-vapor-ui-dashboard" class="sidebar-link">Installing The Vapor UI Dashboard</a></li><li class="sidebar-sub-header"><a href="/1.0/introduction.html#teams" class="sidebar-link">Teams</a></li><li class="sidebar-sub-header"><a href="/1.0/introduction.html#linking-with-aws" class="sidebar-link">Linking With AWS</a></li><li class="sidebar-sub-header"><a href="/1.0/introduction.html#notification-methods" class="sidebar-link">Notification Methods</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Projects</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/1.0/projects/the-basics.html" class="sidebar-link">The Basics</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/projects/the-basics.html#creating-projects" class="sidebar-link">Creating Projects</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/the-basics.html#project-settings" class="sidebar-link">Project Settings</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/the-basics.html#deleting-projects" class="sidebar-link">Deleting Projects</a></li></ul></li><li><a href="/1.0/projects/environments.html" class="sidebar-link">Environments</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#creating-environments" class="sidebar-link">Creating Environments</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#opening-environments" class="sidebar-link">Opening Environments</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#environment-variables" class="sidebar-link">Environment Variables</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#secrets" class="sidebar-link">Secrets</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#vanity-urls" class="sidebar-link">Vanity URLs</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#custom-domains" class="sidebar-link">Custom Domains</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#maintenance-mode" class="sidebar-link">Maintenance Mode</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#commands" class="sidebar-link">Commands</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#memory" class="sidebar-link">Memory</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#concurrency" class="sidebar-link">Concurrency</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#provisioned-concurrency" class="sidebar-link">Provisioned Concurrency</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#prewarming" class="sidebar-link">Prewarming</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#firewall" class="sidebar-link">Firewall</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#timeout" class="sidebar-link">Timeout</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#scheduler" class="sidebar-link">Scheduler</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#mail" class="sidebar-link">Mail</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#metrics" class="sidebar-link">Metrics</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#runtime" class="sidebar-link">Runtime</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#octane" class="sidebar-link">Octane</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#gateway-versions" class="sidebar-link">Gateway Versions</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#custom-vpcs" class="sidebar-link">Custom VPCs</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#deleting-environments" class="sidebar-link">Deleting Environments</a></li></ul></li><li><a href="/1.0/projects/deployments.html" class="sidebar-link">Deployments</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/projects/deployments.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/deployments.html#initiating-deployments" class="sidebar-link">Initiating Deployments</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/deployments.html#build-hooks" class="sidebar-link">Build Hooks</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/deployments.html#deploy-hooks" class="sidebar-link">Deploy Hooks</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/deployments.html#assets" class="sidebar-link">Assets</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/deployments.html#redeploying" class="sidebar-link">Redeploying</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/deployments.html#rollbacks" class="sidebar-link">Rollbacks</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/deployments.html#deploying-from-ci" class="sidebar-link">Deploying From CI</a></li></ul></li><li><a href="/1.0/projects/development.html" class="sidebar-link">Development</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/projects/development.html#binary-responses" class="sidebar-link">Binary Responses</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/development.html#configuring-openssl" class="sidebar-link">Configuring OpenSSL</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/development.html#after-response-jobs" class="sidebar-link">&quot;After Response&quot; Jobs</a></li></ul></li><li><a href="/1.0/projects/troubleshooting.html" class="sidebar-link">Troubleshooting</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/projects/troubleshooting.html#performance-issues" class="sidebar-link">Performance Issues</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/troubleshooting.html#_502-bad-gateway-or-internal-server-error" class="sidebar-link">502 Bad Gateway Or &quot;Internal Server Error&quot;</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Resources</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/1.0/resources/queues.html" class="sidebar-link">Queues</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/resources/queues.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/queues.html#custom-queue-names" class="sidebar-link">Custom Queue Names</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/queues.html#queue-concurrency" class="sidebar-link">Queue Concurrency</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/queues.html#queue-visibility-timeout" class="sidebar-link">Queue Visibility Timeout</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/queues.html#queue-memory" class="sidebar-link">Queue Memory</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/queues.html#queue-database-connections" class="sidebar-link">Queue Database Connections</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/queues.html#monitoring-jobs" class="sidebar-link">Monitoring Jobs</a></li></ul></li><li><a href="/1.0/resources/storage.html" class="sidebar-link">Storage</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/resources/storage.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/storage.html#attaching-storage" class="sidebar-link">Attaching Storage</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/storage.html#mounting-a-persistent-file-system" class="sidebar-link">Mounting A Persistent File System</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/storage.html#file-uploads" class="sidebar-link">File Uploads</a></li></ul></li><li><a href="/1.0/resources/networks.html" class="sidebar-link">Networks</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/resources/networks.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/networks.html#jumpboxes" class="sidebar-link">Jumpboxes</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/networks.html#nat-gateways" class="sidebar-link">NAT Gateways</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/networks.html#load-balancers" class="sidebar-link">Load Balancers</a></li></ul></li><li><a href="/1.0/resources/databases.html" aria-current="page" class="active sidebar-link">Databases</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/resources/databases.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/databases.html#creating-databases" class="sidebar-link">Creating Databases</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/databases.html#using-databases" class="sidebar-link">Using Databases</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/databases.html#database-proxies" class="sidebar-link">Database Proxies</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/databases.html#database-users" class="sidebar-link">Database Users</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/databases.html#scaling-databases" class="sidebar-link">Scaling Databases</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/databases.html#restoring-databases" class="sidebar-link">Restoring Databases</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/databases.html#upgrading-databases" class="sidebar-link">Upgrading Databases</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/databases.html#metrics" class="sidebar-link">Metrics</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/databases.html#deleting-databases" class="sidebar-link">Deleting Databases</a></li></ul></li><li><a href="/1.0/resources/caches.html" class="sidebar-link">Caches</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/resources/caches.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/caches.html#creating-caches" class="sidebar-link">Creating Caches</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/caches.html#using-caches" class="sidebar-link">Using Caches</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/caches.html#scaling-caches" class="sidebar-link">Scaling Caches</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/caches.html#metrics" class="sidebar-link">Metrics</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/caches.html#dynamodb-caches" class="sidebar-link">DynamoDB Caches</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/caches.html#deleting-caches" class="sidebar-link">Deleting Caches</a></li></ul></li><li><a href="/1.0/resources/logs.html" class="sidebar-link">Logs</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/resources/logs.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/logs.html#viewing-logs" class="sidebar-link">Viewing Logs</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Domains</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/1.0/domains/dns.html" class="sidebar-link">DNS</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/domains/dns.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/1.0/domains/dns.html#creating-dns-zones" class="sidebar-link">Creating DNS Zones</a></li><li class="sidebar-sub-header"><a href="/1.0/domains/dns.html#nameservers" class="sidebar-link">Nameservers</a></li><li class="sidebar-sub-header"><a href="/1.0/domains/dns.html#managing-dns-records" class="sidebar-link">Managing DNS Records</a></li><li class="sidebar-sub-header"><a href="/1.0/domains/dns.html#deleting-zones" class="sidebar-link">Deleting Zones</a></li></ul></li><li><a href="/1.0/domains/certificates.html" class="sidebar-link">Certificates</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/domains/certificates.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/1.0/domains/certificates.html#creating-certificates" class="sidebar-link">Creating Certificates</a></li><li class="sidebar-sub-header"><a href="/1.0/domains/certificates.html#deleting-certificates" class="sidebar-link">Deleting Certificates</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="databases"><a href="#databases" class="header-anchor">#</a> Databases</h1> <p></p><div class="table-of-contents"><ul><li><a href="#introduction">Introduction</a></li><li><a href="#creating-databases">Creating Databases</a><ul><li><a href="#the-default-database">The Default Database</a></li><li><a href="#database-types">Database Types</a></li><li><a href="#quick-development-databases">Quick Development Databases</a></li></ul></li><li><a href="#using-databases">Using Databases</a><ul><li><a href="#connecting-to-private-databases-locally">Connecting To Private Databases Locally</a></li></ul></li><li><a href="#database-proxies">Database Proxies</a></li><li><a href="#database-users">Database Users</a></li><li><a href="#scaling-databases">Scaling Databases</a></li><li><a href="#restoring-databases">Restoring Databases</a></li><li><a href="#upgrading-databases">Upgrading Databases</a></li><li><a href="#metrics">Metrics</a><ul><li><a href="#alarms">Alarms</a></li></ul></li><li><a href="#deleting-databases">Deleting Databases</a></li></ul></div><p></p> <h2 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h2> <p>Vapor allows you to easily create and manage RDS and Aurora Serverless databases directly from the Vapor UI or using the Vapor CLI. <strong>Database backups are automatically performed and you may restore a database to any point in time (down to the second) within the backup retention window.</strong></p> <h2 id="creating-databases"><a href="#creating-databases" class="header-anchor">#</a> Creating Databases</h2> <p>You may create databases using the Vapor UI or using the <code>database</code> CLI command. When using the CLI command, the command will prompt you for more details about the database such as its desired performance class and maximum storage space.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>vapor database my-application-db
</code></pre></div><h3 id="the-default-database"><a href="#the-default-database" class="header-anchor">#</a> The Default Database</h3> <p>Vapor will automatically create a &quot;vapor&quot; database within each database instance that you create. You are free to create additional databases using the database management tool of your choice.</p> <h3 id="database-types"><a href="#database-types" class="header-anchor">#</a> Database Types</h3> <p>When creating Vapor databases, you may choose from two different types of databases: fixed size and auto-scaling serverless databases.</p> <h4 id="fixed-size-databases"><a href="#fixed-size-databases" class="header-anchor">#</a> Fixed Size Databases</h4> <p>Fixed sized databases are RDS MySQL 5.7 / RDS MySQL 8 / Postgres 10 / Postgres 11 / Postgres 13 databases that have a fixed amount of RAM and disk space. These databases may be scaled up or down after creation, but not without incurring downtime.</p> <p>In addition, these databases may be publicly accessible (with a long, random password automatically assigned by Vapor) or private. Private databases may not typically be accessed from the public Internet. To access them from your local machine, you will need to create a Vapor jumpbox.</p> <div class="custom-block warning"><p class="custom-block-title">Private Databases</p> <p>Vapor will place any application that uses a private database in a network with a <a href="/1.0/resources/networks.html#nat-gateways">NAT Gateway</a>. Later, if you no longer plan to use the database and are using no other private resources from your application, you may remove the NAT Gateway from your network via the network's management screen.</p></div> <h4 id="serverless-databases"><a href="#serverless-databases" class="header-anchor">#</a> Serverless Databases</h4> <p>Serverless databases are auto-scaling Aurora MySQL 5.7 / Postgres 10 databases which do not have a fixed amount of RAM or disk space. Instead, these databases automatically scale based on the needs of your application. At their smallest scale, they are allocated 1GB of RAM.</p> <div class="custom-block warning"><p class="custom-block-title">Serverless Databases</p> <p>AWS requires all serverless databases to be private, meaning Vapor will place any application that uses them in a network with a <a href="/1.0/resources/networks.html#nat-gateways">NAT Gateway</a>. If you no longer plan to use a serverless database and are using no other private resources from your application, you may remove the NAT Gateway from your network via the network's management screen.</p></div> <h3 id="quick-development-databases"><a href="#quick-development-databases" class="header-anchor">#</a> Quick Development Databases</h3> <p>To quickly create a publicly accessible database of the smallest performance class, you may use the <code>--dev</code> flag when creating your database. These small, affordable databases are perfect for testing or staging environments:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>vapor database my-test-database --dev
</code></pre></div><h2 id="using-databases"><a href="#using-databases" class="header-anchor">#</a> Using Databases</h2> <p>To attach a database to an environment, add a <code>database</code> key to the environment's configuration in your <code>vapor.yml</code> file and deploy your application. The value of this key should be the name of the database. <strong>When the environment is deployed, Vapor will automatically inject the necessary Laravel environment variables for connecting to the database, allowing your application to start using it immediately:</strong></p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">id</span><span class="token punctuation">:</span> <span class="token number">3</span>
<span class="token key atrule">name</span><span class="token punctuation">:</span> vapor<span class="token punctuation">-</span>app
<span class="token key atrule">environments</span><span class="token punctuation">:</span>
    <span class="token key atrule">production</span><span class="token punctuation">:</span>
        <span class="token key atrule">database</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>application<span class="token punctuation">-</span>db
        <span class="token key atrule">build</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token string">'composer install --no-dev'</span>
        <span class="token key atrule">deploy</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token string">'php artisan migrate --force'</span>
</code></pre></div><h3 id="connecting-to-private-databases-locally"><a href="#connecting-to-private-databases-locally" class="header-anchor">#</a> Connecting To Private Databases Locally</h3> <p>If you would like to connect to your private database from your local machine, you can either use a Vapor <a href="/1.0/resources/networks.html#jumpboxes">jumpbox</a> in combination with a GUI database management tool or the <code>database:shell</code> CLI command. Jumpboxes are very small, SSH accessible servers that are placed within your private network.</p> <h4 id="jumpboxes-gui-tool"><a href="#jumpboxes-gui-tool" class="header-anchor">#</a> Jumpboxes + GUI Tool</h4> <p>Once a jumpbox has been created, you may configure your database management tool to connect to your database through the jumpbox SSH connection:</p> <p><img src="/assets/img/jumpbox-db-connection-settings.b12d28b8.png" alt="Database GUI Connection Settings"></p> <h4 id="shell-command"><a href="#shell-command" class="header-anchor">#</a> Shell Command</h4> <p>After provisioning a jumpbox, you may use the <code>database:shell</code> command to quickly access a command line database shell that lets you interact with your database:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>vapor database:shell my-application-db
</code></pre></div><h2 id="database-proxies"><a href="#database-proxies" class="header-anchor">#</a> Database Proxies</h2> <p>Even though your serverless Laravel applications running on Vapor can handle extreme amounts of web traffic, traditional relational databases such as MySQL can become overwhelmed and crash due to connection limit restrictions. To solve this, you may use an RDS proxy to efficiently manage your database connections and allow many more connections than would typically be possible.</p> <p>The database proxy can be added via the Vapor UI or the <code>database:proxy</code> CLI command:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>vapor database:proxy my-application-db
</code></pre></div><p>Next, you may instruct an environment to use the proxy associated with the database using the <code>database-proxy</code> configuration option within your <code>vapor.yml</code> file:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">id</span><span class="token punctuation">:</span> <span class="token number">3</span>
<span class="token key atrule">name</span><span class="token punctuation">:</span> vapor<span class="token punctuation">-</span>app
<span class="token key atrule">environments</span><span class="token punctuation">:</span>
    <span class="token key atrule">production</span><span class="token punctuation">:</span>
        <span class="token key atrule">database</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>application<span class="token punctuation">-</span>db
        <span class="token key atrule">database-proxy</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">build</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token string">'composer install --no-dev'</span>
        <span class="token key atrule">deploy</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token string">'php artisan migrate --force'</span>
</code></pre></div><p>You can delete the proxy at any time using the Vapor UI or the <code>database:delete-proxy</code> CLI command. Before deleting a proxy, make sure none of your applications are using the associated proxy:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>vapor database:delete-proxy my-application-db
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">Limitations</p> <p>Before considering the usage of database proxies in Vapor, please consult Amazon's <a href="https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/rds-proxy.html#rds-proxy.limitations" target="_blank" rel="noopener noreferrer">list of limitations<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p></div> <h2 id="database-users"><a href="#database-users" class="header-anchor">#</a> Database Users</h2> <p>When a database is created, Vapor creates a &quot;vapor&quot; master user. You may create additional database users, which will automatically be assigned a secure, random password, using the Vapor UI or the <code>database:user</code> CLI command:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>vapor database:user my-application-db user-2
</code></pre></div><p>You may instruct an environment to connect to a database as a given user using the <code>database-user</code> configuration option within your <code>vapor.yml</code> file:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">id</span><span class="token punctuation">:</span> <span class="token number">3</span>
<span class="token key atrule">name</span><span class="token punctuation">:</span> vapor<span class="token punctuation">-</span>app
<span class="token key atrule">environments</span><span class="token punctuation">:</span>
    <span class="token key atrule">production</span><span class="token punctuation">:</span>
        <span class="token key atrule">database</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>application<span class="token punctuation">-</span>db
        <span class="token key atrule">database-user</span><span class="token punctuation">:</span> user<span class="token punctuation">-</span><span class="token number">2</span>
        <span class="token key atrule">build</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token string">'composer install --no-dev'</span>
        <span class="token key atrule">deploy</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token string">'php artisan migrate --force'</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">Database Password Rotation</p> <p>You may leverage users to &quot;rotate&quot; the password of a database without downtime by creating a new user, updating the environment to use that user, deploying the environment, and then deleting the old database user.</p></div> <h2 id="scaling-databases"><a href="#scaling-databases" class="header-anchor">#</a> Scaling Databases</h2> <p>You may scale fixed size databases via the Vapor UI's database detail screen or the <code>database:scale</code> CLI command. When scaling a fixed size database, the database will be unavailable, and the amount of time it takes to scale the database could vary based on the size of the database. Therefore, you should place your application in maintenance mode before beginning the scaling operation:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>vapor database:scale my-application-db
</code></pre></div><h2 id="restoring-databases"><a href="#restoring-databases" class="header-anchor">#</a> Restoring Databases</h2> <p>Vapor database backups are performed automatically and you may restore databases to any point in time within the database backup retention period, which is three days by default. You can change the database backup retention period at any time via the Vapor UI's database details screen.</p> <p>Database restoration may be initiated via the Vapor UI or the <code>database:restore</code> CLI command:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>vapor database:restore current-database-name new-database-name
</code></pre></div><p>When restoring a database, a new database is created with the same configuration as the previous database. Then, the previous database's contents are restored to the new database as they existed at the exact point in time you choose. To attach the restored database to an environment, update the value of the <code>database</code> key in your <code>vapor.yml</code> file and deploy the environment.</p> <p>Once you are satisfied with the database restoration, you may delete the old database.</p> <h2 id="upgrading-databases"><a href="#upgrading-databases" class="header-anchor">#</a> Upgrading Databases</h2> <p>You may upgrade a Vapor managed MySQL database via the Vapor UI or the <code>database:upgrade</code> CLI command. When upgrading a database, a new database is created with the same configuration and credentials as the original database:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>vapor database:upgrade current-database-name new-database-name
</code></pre></div><p>Keep in mind that major version upgrades can contain database changes that are not backward-compatible with existing applications. For that reason, we recommend that you thoroughly test the new upgraded database version before attaching it to a production environment. The original database will not be affected by this operation at any point.</p> <p>Upgrading a database can take several hours for large databases. Therefore, if you plan to attach the new database to a production environment, you may want to place any affected environments in maintenance mode first. Once the newly upgraded database is available, you may start using it by attaching it to an environment.</p> <p>Of course, once you are satisfied with the database upgrade, you may delete the original database.</p> <h2 id="metrics"><a href="#metrics" class="header-anchor">#</a> Metrics</h2> <p>A variety of database performance metrics are available via the Vapor UI's database detail screen or using the <code>database:metrics</code> CLI command:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>vapor database:metrics my-application-db
vapor database:metrics my-application-db 5m
vapor database:metrics my-application-db 30m
vapor database:metrics my-application-db 1h
vapor database:metrics my-application-db 8h
vapor database:metrics my-application-db 1d
vapor database:metrics my-application-db 3d
vapor database:metrics my-application-db 7d
vapor database:metrics my-application-db 1M
</code></pre></div><h3 id="alarms"><a href="#alarms" class="header-anchor">#</a> Alarms</h3> <p>You may configure alarms for all database metrics using the Vapor UI. These alarms will notify you via the notification method of your choice when an alarm's configured threshold is broken and when an alarm recovers.</p> <h2 id="deleting-databases"><a href="#deleting-databases" class="header-anchor">#</a> Deleting Databases</h2> <p>Databases may be deleted via the Vapor UI or using the <code>database:delete</code> CLI command. Once a database has been deleted, it can not be recovered, so take extra caution before deleting a database:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>vapor database:delete my-application-db
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/1.0/resources/networks.html" class="prev">
        Networks
      </a></span> <span class="next"><a href="/1.0/resources/caches.html">
        Caches
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.f51d531d.js" defer></script><script src="/assets/js/2.cb24c26d.js" defer></script><script src="/assets/js/6.2129aa45.js" defer></script>
  </body>
</html>
