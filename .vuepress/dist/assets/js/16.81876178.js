(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{421:function(e,a,r){"use strict";r.r(a);var t=r(56),o=Object(t.a)({},(function(){var e=this,a=e.$createElement,r=e._self._c||a;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"troubleshooting"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#troubleshooting"}},[e._v("#")]),e._v(" Troubleshooting")]),e._v(" "),r("p"),r("div",{staticClass:"table-of-contents"},[r("ul",[r("li",[r("a",{attrs:{href:"#performance-issues"}},[e._v("Performance Issues")])]),r("li",[r("a",{attrs:{href:"#_502-bad-gateway-or-internal-server-error"}},[e._v('502 Bad Gateway Or "Internal Server Error"')])])])]),r("p"),e._v(" "),r("h2",{attrs:{id:"performance-issues"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#performance-issues"}},[e._v("#")]),e._v(" Performance Issues")]),e._v(" "),r("p",[e._v("While you can achieve blazing-fast load times in your Laravel applications powered by Vapor, you may face performance issues if you misconfigure your infrastructure.")]),e._v(" "),r("p",[e._v("In this section, we'll cover the Vapor "),r("strong",[e._v("most common infrastructure performance tips")]),e._v(" that may speed your Laravel applications powered by Vapor. Before we dive in, please keep in mind:")]),e._v(" "),r("ol",[r("li",[r("p",[r("strong",[e._v("Optimize your application first")]),e._v(": by making your application faster you may not require any infrastructure changes at all. Identify application performance bottlenecks and try to solve them using simple techniques such as caching, queuing, or database query optimizations.")])]),e._v(" "),r("li",[r("p",[r("strong",[e._v("Infrastructure changes may have an impact on your AWS bill")]),e._v(": Of course, allocating more (or different) resources for your Vapor environment may cause your AWS bill to increase. Therefore, you may need to study how the pricing of that changes will affect your AWS bill: "),r("strong",[r("a",{attrs:{href:"https://aws.amazon.com/pricing/",target:"_blank",rel:"noopener noreferrer"}},[e._v("aws.amazon.com/pricing"),r("OutboundLink")],1)]),e._v(".")])])]),e._v(" "),r("h4",{attrs:{id:"increasing-the-memory-option"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#increasing-the-memory-option"}},[e._v("#")]),e._v(" Increasing the "),r("code",[e._v("memory")]),e._v(" option")]),e._v(" "),r("p",[e._v("Vapor - via AWS Lambda - allocates CPU power to your Lambda function in proportion to the amount of memory configured for the environment. Therefore, increasing the memory may lead to better performance as the Lambda function will have more CPU power to process your requests and queued jobs.")]),e._v(" "),r("p",[e._v("You may increase the configured memory for the HTTP Lambda function, Queue Lambda function, or CLI Lambda function using the "),r("a",{attrs:{href:"https://docs.vapor.build/1.0/projects/environments.html#memory",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("memory")]),r("OutboundLink")],1),e._v(", "),r("a",{attrs:{href:"https://docs.vapor.build/1.0/resources/queues.html#queue-memory",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("queue-memory")]),r("OutboundLink")],1),e._v(", or "),r("code",[e._v("cli-memory")]),e._v(" options, respectively, in your environment's "),r("code",[e._v("vapor.yml")]),e._v(" configuration.")]),e._v(" "),r("h4",{attrs:{id:"increasing-the-warm-option"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#increasing-the-warm-option"}},[e._v("#")]),e._v(" Increasing the "),r("code",[e._v("warm")]),e._v(" option")]),e._v(" "),r("p",[e._v('If you are facing post-deployment performance issues at scale, that may indicate that your environment does not "pre-warm" enough containers in advance. Therefore, some requests incur a penalty of a few seconds while AWS loads a serverless container to process the request.')]),e._v(" "),r("p",[e._v('To mitigate this issue - commonly known as "cold-starts" - Vapor allows you to define a '),r("a",{attrs:{href:"https://docs.vapor.build/1.0/projects/environments.html#prewarming",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("warm")]),r("OutboundLink")],1),e._v(" configuration value for an environment in your "),r("code",[e._v("vapor.yml")]),e._v(" file. The "),r("code",[e._v("warm")]),e._v(' value represents how many serverless containers Vapor will "pre-warm" so they can be ready to serve requests.')]),e._v(" "),r("h4",{attrs:{id:"using-fixed-size-databases"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#using-fixed-size-databases"}},[e._v("#")]),e._v(' Using "fixed-size" databases')]),e._v(" "),r("p",[e._v('Serverless databases are auto-scaling databases that do not have a fixed amount of RAM or disk space. Yet, the "auto-scaling" mechanism offered by AWS can have cold start times of up to a few seconds every time your environment needs more database resources.')]),e._v(" "),r("p",[e._v('To mitigate this issue, consider using "fixed-size" databases where resources are prepared in advance. You may '),r("a",{attrs:{href:"https://docs.vapor.build/1.0/resources/databases.html#fixed-size-databases",target:"_blank",rel:"noopener noreferrer"}},[e._v('create "fixed-size" databases'),r("OutboundLink")],1),e._v(" using the Vapor UI or using the "),r("code",[e._v("database")]),e._v(" CLI command.")]),e._v(" "),r("h4",{attrs:{id:"using-database-proxies"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#using-database-proxies"}},[e._v("#")]),e._v(" Using database proxies")]),e._v(" "),r("p",[e._v("Even though your serverless Laravel applications powered by Vapor can handle extreme amounts of web traffic, traditional relational databases such as MySQL can become overwhelmed and crash due to connection limit restrictions.")]),e._v(" "),r("p",[e._v("To mitigate this issue, Vapor allows the usage of an "),r("strong",[r("a",{attrs:{href:"https://aws.amazon.com/rds/proxy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("RDS proxy"),r("OutboundLink")],1)]),e._v(" to efficiently manage your database connections and allow many more connections than would typically be possible. The database proxy "),r("a",{attrs:{href:"https://docs.vapor.build/1.0/resources/databases.html#database-proxies",target:"_blank",rel:"noopener noreferrer"}},[e._v("can be added"),r("OutboundLink")],1),e._v(" via the Vapor UI or the "),r("code",[e._v("database:proxy")]),e._v(" CLI command.")]),e._v(" "),r("h4",{attrs:{id:"scale-existing-fixed-size-resources"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#scale-existing-fixed-size-resources"}},[e._v("#")]),e._v(' Scale existing "fixed-size" resources')]),e._v(" "),r("p",[e._v('If you are facing performance issues at scale, that may indicate that existing resources - such as "fixed-size" databases or "fixed-size" caches - may not be able to keep up with the number of tasks managed by your application.')]),e._v(" "),r("p",[e._v('To mitigate this issue, consider scale existing "fixed-size" resources, if any. For example, you may '),r("a",{attrs:{href:"https://docs.vapor.build/1.0/resources/databases.html#scaling-databases",target:"_blank",rel:"noopener noreferrer"}},[e._v('scale "fixed-size" databases'),r("OutboundLink")],1),e._v(" via the Vapor UI's database detail screen or the "),r("code",[e._v("database:scale")]),e._v(" CLI command.")]),e._v(" "),r("h4",{attrs:{id:"consider-redis-over-dynamodb"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#consider-redis-over-dynamodb"}},[e._v("#")]),e._v(" Consider Redis over DynamoDB")]),e._v(" "),r("p",[e._v("If your application heavily relies on caching - which is already a great way to massively speed up your application - using a Redis cache instead of DynamoDB can speed up cache IO.")]),e._v(" "),r("p",[e._v("You may "),r("a",{attrs:{href:"https://docs.vapor.build/1.0/resources/caches.html#introduction",target:"_blank",rel:"noopener noreferrer"}},[e._v("create caches"),r("OutboundLink")],1),e._v(" using the Vapor UI or using the "),r("code",[e._v("cache")]),e._v(" CLI command.")]),e._v(" "),r("h4",{attrs:{id:"consider-api-gateway-v2-instead-of-api-gateway-v1"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#consider-api-gateway-v2-instead-of-api-gateway-v1"}},[e._v("#")]),e._v(" Consider API Gateway v2 instead of API Gateway v1")]),e._v(" "),r("p",[e._v("By migrating from API Gateway v1 to API Gateway v2, you can expect 50% less latency in the requests to your application. However, API Gateway v2 is regional, meaning that customers from a region very distant from your project may be negatively affected by this change. Also, some features, like Vapor's managed Firewall, may not be available.")]),e._v(" "),r("p",[e._v("If you would like to "),r("a",{attrs:{href:"https://docs.vapor.build/1.0/projects/environments.html#gateway-versions",target:"_blank",rel:"noopener noreferrer"}},[e._v("use API Gateway 2.0"),r("OutboundLink")],1),e._v(", you may specify "),r("code",[e._v("gateway-version: 2")]),e._v(" in your environment's "),r("code",[e._v("vapor.yml")]),e._v(" configuration.")]),e._v(" "),r("h4",{attrs:{id:"contact-aws-support"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#contact-aws-support"}},[e._v("#")]),e._v(" Contact AWS Support")]),e._v(" "),r("p",[e._v("Laravel Vapor provisions and configures your projects on the AWS infrastructure. However, for performance insights regarding your infrastructure, we recommend you to reach out to "),r("a",{attrs:{href:"https://console.aws.amazon.com/support/home?#/case/create?issueType=technical",target:"_blank",rel:"noopener noreferrer"}},[e._v("AWS Support"),r("OutboundLink")],1),e._v(" as they can deeply examine the internal logs of your infrastructure.")]),e._v(" "),r("h2",{attrs:{id:"_502-bad-gateway-or-internal-server-error"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_502-bad-gateway-or-internal-server-error"}},[e._v("#")]),e._v(' 502 Bad Gateway Or "Internal Server Error"')]),e._v(" "),r("p",[e._v('Typically, a 502 Bad Gateway or an "Internal Server Error" is thrown when the Lambda function fails to handle the request internally. Most of the time this is because the request has timed out or because the payload / response is exceeding the size allowed by AWS.')]),e._v(" "),r("p",[e._v('You can see if a request has timed out by searching for "Task timed out" messages in your environment logs. Here are some common solutions to "time out" issues:')]),e._v(" "),r("ol",[r("li",[e._v("Change the "),r("a",{attrs:{href:"https://docs.vapor.build/1.0/projects/environments.html#timeout",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("timeout")]),r("OutboundLink")],1),e._v(" value on your "),r("code",[e._v("vapor.yml")]),e._v(" file and deploy your application again.")]),e._v(" "),r("li",[e._v('Try to identify the code that may be causing this "time out" issue. This may be related resources configured incorrectly, or a task may take longer than expected — in this case, please consider using '),r("a",{attrs:{href:"https://docs.vapor.build/1.0/resources/queues.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("queues"),r("OutboundLink")],1),e._v(" for heavy tasks.")]),e._v(" "),r("li",[e._v("Alternatively, you can reach "),r("a",{attrs:{href:"https://console.aws.amazon.com/support/home?#/case/create?issueType=technical",target:"_blank",rel:"noopener noreferrer"}},[e._v("AWS Support"),r("OutboundLink")],1),e._v(" - as they can deeply examine the internal logs of your infrastructure.")])]),e._v(" "),r("p",[e._v("If you don't see any \"Task timed out\" messages in your environment logs, this indicates the error is likely because the payload / response is exceeding the size allowed by AWS. Please consult AWS's "),r("a",{attrs:{href:"https://docs.aws.amazon.com/apigateway/latest/developerguide/limits.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("API Gateway"),r("OutboundLink")],1),e._v(" and "),r("a",{attrs:{href:"https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-limits.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Load Balancers"),r("OutboundLink")],1),e._v(" quotas.")])])}),[],!1,null,null,null);a.default=o.exports}}]);