(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{414:function(a,e,t){"use strict";t.r(e);var c=t(56),s=Object(c.a)({},(function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"caches"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#caches"}},[a._v("#")]),a._v(" Caches")]),a._v(" "),t("p"),t("div",{staticClass:"table-of-contents"},[t("ul",[t("li",[t("a",{attrs:{href:"#introduction"}},[a._v("Introduction")])]),t("li",[t("a",{attrs:{href:"#creating-caches"}},[a._v("Creating Caches")])]),t("li",[t("a",{attrs:{href:"#using-caches"}},[a._v("Using Caches")]),t("ul",[t("li",[t("a",{attrs:{href:"#connecting-to-caches-locally"}},[a._v("Connecting To Caches Locally")])])])]),t("li",[t("a",{attrs:{href:"#scaling-caches"}},[a._v("Scaling Caches")])]),t("li",[t("a",{attrs:{href:"#metrics"}},[a._v("Metrics")])]),t("li",[t("a",{attrs:{href:"#dynamodb-caches"}},[a._v("DynamoDB Caches")])]),t("li",[t("a",{attrs:{href:"#deleting-caches"}},[a._v("Deleting Caches")])])])]),t("p"),a._v(" "),t("h2",{attrs:{id:"introduction"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#introduction"}},[a._v("#")]),a._v(" Introduction")]),a._v(" "),t("p",[a._v("Vapor allows you to easily create and manage scalable Redis clusters directly from the Vapor UI or using the Vapor CLI. AWS requires all cache clusters to be private, meaning Vapor will place any application that uses them in a network with a "),t("RouterLink",{attrs:{to:"/1.0/resources/networks.html#nat-gateways"}},[a._v("NAT Gateway")]),a._v(".")],1),a._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[a._v("DynamoDB Caches")]),a._v(" "),t("p",[a._v("If you are primarily using a cache for Laravel's task scheduler and atomic locks, you may find that using a "),t("a",{attrs:{href:"#dynamodb-caches"}},[a._v("DynamoDB cache")]),a._v(" is a cost-efficient alternative to using Redis clusters. In addition, DynamoDB caches do not require Vapor to attach a NAT Gateway to your application's network.")]),a._v(" "),t("p",[a._v("If no Redis cache is attached to the environment, the DynamoDB cache will automatically be set as the default cache driver.")])]),a._v(" "),t("h2",{attrs:{id:"creating-caches"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#creating-caches"}},[a._v("#")]),a._v(" Creating Caches")]),a._v(" "),t("p",[a._v("You may create caches using the Vapor UI or using the "),t("code",[a._v("cache")]),a._v(" CLI command. When using the CLI command, the command will prompt you for more details about the cache such as its desired performance class:")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("vapor cache my-application-cache\n")])])]),t("h2",{attrs:{id:"using-caches"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#using-caches"}},[a._v("#")]),a._v(" Using Caches")]),a._v(" "),t("p",[a._v("To attach a cache to an environment, add a "),t("code",[a._v("cache")]),a._v(" key to the environment's configuration in your "),t("code",[a._v("vapor.yml")]),a._v(" file. The value of this key should be the name of the cache. "),t("strong",[a._v("When the environment is deployed, Vapor will automatically inject the necessary Laravel environment variables for connecting to the cache, allowing your application to start using it immediately:")])]),a._v(" "),t("div",{staticClass:"language-yaml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("id")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" vapor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("app\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("environments")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("production")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("cache")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" my"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("application"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("cache\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("build")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'composer install --no-dev'")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("deploy")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'php artisan migrate --force'")]),a._v("\n")])])]),t("h3",{attrs:{id:"connecting-to-caches-locally"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#connecting-to-caches-locally"}},[a._v("#")]),a._v(" Connecting To Caches Locally")]),a._v(" "),t("p",[a._v("If you would like to connect to your cache cluster from your local machine, you can use a Vapor "),t("RouterLink",{attrs:{to:"/1.0/resources/networks.html#jumpboxes"}},[a._v("jumpbox")]),a._v(" in combination with the "),t("code",[a._v("cache:tunnel")]),a._v(" CLI command. Jumpboxes are very small, SSH accessible servers that are placed within your private network.")],1),a._v(" "),t("p",[a._v("Once a jumpbox has been created in your cache's network, you may execute the "),t("code",[a._v("cache:tunnel")]),a._v(" command. This command will make your Redis cache cluster available on "),t("code",[a._v("localhost:6378")]),a._v(", allowing you to access it with the Redis management tool of your choice, such as "),t("a",{attrs:{href:"http://getmedis.com",target:"_blank",rel:"noopener noreferrer"}},[a._v("Medis"),t("OutboundLink")],1),a._v(".")]),a._v(" "),t("h2",{attrs:{id:"scaling-caches"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#scaling-caches"}},[a._v("#")]),a._v(" Scaling Caches")]),a._v(" "),t("p",[a._v("You may scale caches via the Vapor UI's cache detail screen or the "),t("code",[a._v("cache:scale")]),a._v(' CLI command. When scaling a cache, you will be prompted to specify the number of "nodes" you wish to scale up or down to. When scaling a cache via the CLI, you should specify your desired number of nodes when executing the '),t("code",[a._v("cache:scale")]),a._v(" command.")]),a._v(" "),t("p",[a._v("Think of each node as a cache server with the performance specs you specified when the cache was created. Cache keys will automatically be sharded across all of your available nodes. Scaling a cache should not typically cause downtime:")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("vapor cache:scale my-application-cache "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),a._v("\n")])])]),t("h2",{attrs:{id:"metrics"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#metrics"}},[a._v("#")]),a._v(" Metrics")]),a._v(" "),t("p",[a._v("A variety of cache performance metrics are available via the Vapor UI's cache detail screen or using the "),t("code",[a._v("cache:metrics")]),a._v(" CLI command:")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("vapor cache:metrics my-application-cache\nvapor cache:metrics my-application-cache 5m\nvapor cache:metrics my-application-cache 30m\nvapor cache:metrics my-application-cache 1h\nvapor cache:metrics my-application-cache 8h\nvapor cache:metrics my-application-cache 1d\nvapor cache:metrics my-application-cache 3d\nvapor cache:metrics my-application-cache 7d\nvapor cache:metrics my-application-cache 1M\n")])])]),t("h2",{attrs:{id:"dynamodb-caches"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dynamodb-caches"}},[a._v("#")]),a._v(" DynamoDB Caches")]),a._v(" "),t("p",[a._v("When you create a project, Vapor will ensure that an auto-scaling DynamoDB cache table is created in that project's region. Then, during deployment, Vapor will automatically populate the environment variables required to interact with this cache using Laravel's built-in "),t("code",[a._v("dynamodb")]),a._v(" cache driver. All you need to do is start using it within your Laravel application!")]),a._v(" "),t("p",[a._v("If no Redis cache is attached to the environment, the DynamoDB cache will automatically be set as the default cache driver. These caches, while not as performant as Redis clusters, provide a very low-cost alternative for applications with light caching requirements.")]),a._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[a._v("Task Scheduler")]),a._v(" "),t("p",[a._v("Vapor automatically configures Laravel's task scheduler to use the DynamoDB cache driver to avoid overlapping tasks.")])]),a._v(" "),t("h2",{attrs:{id:"deleting-caches"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#deleting-caches"}},[a._v("#")]),a._v(" Deleting Caches")]),a._v(" "),t("p",[a._v("Caches may be deleted via the Vapor UI or using the "),t("code",[a._v("cache:delete")]),a._v(" CLI command:")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("vapor cache:delete my-application-cache\n")])])])])}),[],!1,null,null,null);e.default=s.exports}}]);