(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{417:function(a,e,t){"use strict";t.r(e);var s=t(56),n=Object(s.a)({},(function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"networks"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#networks"}},[a._v("#")]),a._v(" Networks")]),a._v(" "),t("p"),t("div",{staticClass:"table-of-contents"},[t("ul",[t("li",[t("a",{attrs:{href:"#introduction"}},[a._v("Introduction")]),t("ul",[t("li",[t("a",{attrs:{href:"#attaching-a-network-to-an-environment"}},[a._v("Attaching A Network To An Environment")])])])]),t("li",[t("a",{attrs:{href:"#jumpboxes"}},[a._v("Jumpboxes")])]),t("li",[t("a",{attrs:{href:"#nat-gateways"}},[a._v("NAT Gateways")]),t("ul",[t("li",[t("a",{attrs:{href:"#what-are-they"}},[a._v("What Are They?")])]),t("li",[t("a",{attrs:{href:"#managing-nat-gateways"}},[a._v("Managing NAT Gateways")])])])]),t("li",[t("a",{attrs:{href:"#load-balancers"}},[a._v("Load Balancers")]),t("ul",[t("li",[t("a",{attrs:{href:"#creating-load-balancers"}},[a._v("Creating Load Balancers")])]),t("li",[t("a",{attrs:{href:"#using-load-balancers"}},[a._v("Using Load Balancers")])]),t("li",[t("a",{attrs:{href:"#deleting-load-balancers"}},[a._v("Deleting Load Balancers")])])])])])]),t("p"),a._v(" "),t("h2",{attrs:{id:"introduction"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#introduction"}},[a._v("#")]),a._v(" Introduction")]),a._v(" "),t("p",[a._v("Networks house your databases, caches, jumpboxes, and occasionally applications within AWS. In general, although they are displayed in the Vapor UI for you to review, you are not required to interact with networks directly when using Vapor. When you create a project in a region that does not contain any previous Vapor projects, Vapor automatically begins provisioning a network for you.")]),a._v(" "),t("h3",{attrs:{id:"attaching-a-network-to-an-environment"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#attaching-a-network-to-an-environment"}},[a._v("#")]),a._v(" Attaching A Network To An Environment")]),a._v(" "),t("p",[a._v("Typically, you do not need to manually add a "),t("code",[a._v("network")]),a._v(" directive to your "),t("code",[a._v("vapor.yml")]),a._v(" file; however, sometimes you may want to manually specify that a Vapor environment should be placed within a given network. This may be the case when you are accessing private AWS resources, such as ElasticSearch, that are not created through Vapor. To place an environment within a network, add the "),t("code",[a._v("network")]),a._v(" directive to your "),t("code",[a._v("vapor.yml")]),a._v(" configuration file:")]),a._v(" "),t("div",{staticClass:"language-yaml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("id")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" vapor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("app\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("environments")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("production")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("network")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" my"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("network\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("build")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'composer install --no-dev'")]),a._v("\n")])])]),t("h2",{attrs:{id:"jumpboxes"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jumpboxes"}},[a._v("#")]),a._v(" Jumpboxes")]),a._v(" "),t("p",[a._v("Some Vapor resources, such as private databases or cache clusters, may not be accessed from the public Internet. Instead, they can only be accessed by a machine within their network. This can make it cumbersome to inspect and manipulate these resources during development. To mitigate this inconvenience, Vapor allows you to create jumpboxes. Jumpboxes are very small, SSH accessible servers that are placed within your private network.")]),a._v(" "),t("p",[a._v("You may create a jumpbox via the Vapor UI's network detail screen or using the "),t("code",[a._v("jump")]),a._v(" CLI command:")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("vapor jump my-jumpbox\n")])])]),t("p",[a._v("Once the jumpbox has been created, Vapor will provide you with the private SSH key needed to access the jumpbox. You should connect to the jumpbox via SSH as the "),t("code",[a._v("ec2-user")]),a._v(" user and the private SSH key.")]),a._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[a._v("Using Jumpboxes")]),a._v(" "),t("p",[a._v("For practical examples of using jumpboxes to make your serverless life easier, check out the "),t("RouterLink",{attrs:{to:"/1.0/resources/databases.html#using-databases"}},[a._v("database")]),a._v(" and "),t("RouterLink",{attrs:{to:"/1.0/resources/caches.html#using-caches"}},[a._v("cache")]),a._v(" documentation.")],1)]),a._v(" "),t("h2",{attrs:{id:"nat-gateways"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nat-gateways"}},[a._v("#")]),a._v(" NAT Gateways")]),a._v(" "),t("h3",{attrs:{id:"what-are-they"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#what-are-they"}},[a._v("#")]),a._v(" What Are They?")]),a._v(" "),t("p",[a._v("If your application interacts with a private database or a cache cluster, your network will require a NAT Gateway. It sounds complicated, but don't worry, Vapor takes care of the heavy lifting. In summary, when a serverless application needs to interact with one of these resources, AWS requires us to place that application within that region's network. By default, this network has no access to the outside Internet, meaning any outgoing API calls from your application will fail. Not good.")]),a._v(" "),t("h3",{attrs:{id:"managing-nat-gateways"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#managing-nat-gateways"}},[a._v("#")]),a._v(" Managing NAT Gateways")]),a._v(" "),t("p",[a._v("Anytime you deploy an application that lists a private database or cache cluster as an attached resource within its "),t("code",[a._v("vapor.yml")]),a._v(" file, Vapor will automatically ensure that the network associated with that database / cache contains a NAT Gateway. If it doesn't, Vapor will automatically begin provisioning one. Unfortunately, AWS bills for NAT Gateways by the hour, resulting in a monthly fee of about $32 / month.")]),a._v(" "),t("p",[a._v("To totally avoid using NAT Gateways, you can use publicly accessible RDS databases (Vapor automatically assigns a long, random password) and a "),t("RouterLink",{attrs:{to:"/1.0/resources/caches.html#dynamodb-caches"}},[a._v("DynamoDB cache table")]),a._v(", which Vapor automatically creates for each of your projects.")],1),a._v(" "),t("p",[a._v("When you delete a private database or cache cluster, and that resource is the last private resource on a given network, Vapor will automatically schedule a job to remove the NAT Gateway from the associated network, thus removing it from your AWS bill. However, you may also manually add or remove NAT Gateways from your networks using the Vapor UI or using the "),t("code",[a._v("network:nat")]),a._v(" and "),t("code",[a._v("network:delete-nat")]),a._v(" CLI commands.")]),a._v(" "),t("h2",{attrs:{id:"load-balancers"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#load-balancers"}},[a._v("#")]),a._v(" Load Balancers")]),a._v(" "),t("p",[a._v("By default, Vapor routes HTTP traffic to your serverless applications using AWS API Gateway. When using this service, AWS only bills you based on the amount of requests your application receives. However, at very high scale, API Gateway can become more expensive than your Lambda functions themselves.")]),a._v(" "),t("p",[a._v("As an alternative to API Gateway, you may route traffic to your application using an Application Load Balancer, which provides large cost savings at scale. For example, if an application receives about 1 billion requests per month, using an Application Load Balancer will save about $4,000 on the application's monthly Amazon bill.")]),a._v(" "),t("h3",{attrs:{id:"creating-load-balancers"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#creating-load-balancers"}},[a._v("#")]),a._v(" Creating Load Balancers")]),a._v(" "),t("p",[a._v("You may create load balancers using the Vapor UI or using the "),t("code",[a._v("balancer")]),a._v(" CLI command. When using the CLI command:")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("vapor balancer my-balancer\n")])])]),t("h3",{attrs:{id:"using-load-balancers"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#using-load-balancers"}},[a._v("#")]),a._v(" Using Load Balancers")]),a._v(" "),t("p",[a._v("To attach a load balancer to an environment, add a "),t("code",[a._v("balancer")]),a._v(" key to the environment's configuration in your "),t("code",[a._v("vapor.yml")]),a._v(" file and deploy your application. The value of this key should be the name of the load balancer.")]),a._v(" "),t("div",{staticClass:"language-yaml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("id")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" vapor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("app\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("environments")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("production")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("balancer")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" my"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("balancer\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("build")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'composer install --no-dev'")]),a._v("\n")])])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[a._v("Load Balancer Certificates")]),a._v(" "),t("p",[a._v("By default, Vapor creates all SSL certificates in the "),t("code",[a._v("us-east-1")]),a._v(" region, regardless of the region of your project. When your application is using API Gateway, AWS will automatically replicate your certificate to all regions behind the scenes.")]),a._v(" "),t("p",[a._v('However, when using an Application Load Balancer to route traffic to your application, you will need to create a certificate in the region that the project is actually deployed to. If you are creating a certificate in the Vapor UI, you can do this by checking the "For Load Balancer" checkbox when creating the certificate.')])]),a._v(" "),t("h3",{attrs:{id:"deleting-load-balancers"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#deleting-load-balancers"}},[a._v("#")]),a._v(" Deleting Load Balancers")]),a._v(" "),t("p",[a._v("Load balancers may be deleted via the Vapor UI or using the "),t("code",[a._v("balancer:delete")]),a._v(" CLI command:")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("vapor balancer:delete my-balancer\n")])])])])}),[],!1,null,null,null);e.default=n.exports}}]);